%% Axe
\draw[->] (0,0,0) -- (9,0,0);
\draw[->] (0,0,0) -- (0,2,0);
\draw[->] (0,0,0) -- (0,0,10) node[right] {$t$};
%% Indices
\draw (0,0,0) node[below] {$0$};
%% Plot Init
\path[draw, color=green, overlay]<2-> plot [id=exp,smooth] function{2*exp(-(x-2)*(x-2)/2) + exp(-(x-6)*(x-6)/2)};
%% Particules
\foreach \p in {6.5, 6.2, 5.5, 5, 3.5, 2.7, 2.2, 2.1, 1.9, 1}
	\path[draw, color=blue, thick, ->, overlay]<3-> (\p, 0) -- (\p, 1);
%% Pred automate
\foreach \p in {6.5, 6.2, 5.5, 5}
	\path[shade, shading=axis, very thick, left color=blue,right color=red, middle color=blue!30!red, overlay]<4-> (\p, 0, 0) rectangle +(0.01, 0, 1.5);
\foreach \p in {6.5, 6.2, 5.5, 5}
	\path[draw, thick, color=red, ->, overlay]<4-> (\p, 0, 1.5) -- (\p, 1, 1.5);
\foreach \p in {3.5, 2.7, 2.2, 2.1, 1.9, 1}
	\path[draw, color=blue, thick, ->, overlay]<4-> (\p, 0, 0) -- (\p, 0, 1.5) -- (\p, 1, 1.5);
%% Pred continue
\foreach \p/\d in {6.5/0.2, 6.2/0.3, 5.5/-0.6, 5/0.6}
	\path[draw, color=red, thick, ->, overlay]<5-> (\p, 0, 1.5) -- ++(\d, 0, 1.5) -- +(0, 1, 0);
\foreach \p/\d in {3.5/0.9, 2.7/0.3, 2.2/0.2, 2.1/1.1, 1.9/1.8, 1/0.3}
	\path[draw, color=blue, thick, ->, overlay]<5-> (\p, 0, 1.5) -- ++(\d, 0, 1.5) -- +(0, 1, 0);
%% Plot Observation
\path[draw, ->, overlay]<6-> (0, 0, 4.5) -- +(9, 0, 0);
\path[draw, color=green, shift={(0,0,4.5)}, overlay]<6-> plot[id=exp,smooth] function{2*exp(-(x-4)*(x-4)/2)};
\path[draw, overlay]<6-> (0,0,4.5) node[below] {$1$};
%% Ponderation
\foreach \p/\d/\w in {6.5/0.2/0.1, 6.2/0.3/0.1, 5.5/-0.6/1.3, 5/0.6/0.5}
	\path[draw, color=red, thick, ->, overlay]<7-> (\p, 0, 3) ++(\d, 0, 0) -- ++(0, 0, 1.5) -- +(0, \w, 0);
\foreach \p/\d/\w in {3.5/0.9/1.9, 2.7/0.3/1.0, 2.2/0.2/0.4, 2.1/1.1/1.2, 1.9/1.8/1.8, 1/0.3/0.1}
	\path[draw, color=blue, thick, ->, overlay]<7-> (\p, 0, 3) ++(\d, 0, 0) -- ++(0, 0, 1.5) -- +(0, \w, 0);
%% Resampling
\foreach \p/\d in {5/0.6}
	\path[shade, shading=axis, thick, left color=red,right color=blue, middle color=blue!30!red, overlay]<8-> (\p, 0, 4.5) ++(\d, 0, 0) rectangle +(0.01, 0, 1.5);
\foreach \p/\d in {5/0.6}
	\path[draw, color=blue, thick, ->, overlay]<8-> (\p, 0, 4.5) ++(\d, 0, 1.5) -- +(0, 1, 0);
\foreach \p/\d/\w in {3.5/0.9/0, 2.7/0.3/0.05, 2.2/0.2/0.05, 2.1/1.1/0.05, 1.9/1.8/0.05, 2.7/0.3/-0.05, 2.2/0.2/-0.05, 2.1/1.1/-0.05, 1.9/1.8/-0.05}
	\path[draw, color=blue, thick, ->, overlay]<8-> (\p, 0, 4.5) ++(\d, 0, 0) -- ++(\w, 0, 1.5) -- +(0, 1, 0);
